<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h1 id="stochasticity-and-genetic-drift-in-allele-frequencies">Stochasticity and Genetic Drift in allele frequencies</h1>
<h2 id="stochastic-loss-of-strongly-selected-alleles">Stochastic loss of strongly selected alleles</h2>
<p>Even strongly selected alleles can be lost from the population when they are sufficiently rare. This is because the number of offspring left by individuals to the next generation is fundamentally stochastic. A selection coefficient of s=<span class="math inline">\(1\%\)</span> is a strong selection coefficient, which can drive an allele through the population in a few hundred generations once the allele is established. However, if individuals have on average a small number of offspring per generation the first individual to carry our allele who has on average <span class="math inline">\(1\%\)</span> more children could easily have zero offspring, leading to the loss of our allele before it ever get a chance to spread.<br />
To take a first stab at this problem lets think of a very large haploid population, and in order for this population to stay constant in size we’ll assume that individuals without the selected mutation have on average one offspring per generation. While individuals with our selected allele have on average <span class="math inline">\(1+s\)</span> offspring per generation. We’ll assume that the distribution of offspring number of an individual is Poisson distributed with this mean, i.e. the probability that an individual with the selected allele has <span class="math inline">\(i\)</span> children is <span class="math display">\[P_i= \frac{(1+s)^i e^{-(1+s)}}{i!}\]</span></p>
<p>Consider starting from a single individual with the selected allele, and ask about the probability of eventual loss of our selected allele starting from this single copy (<span class="math inline">\(p_L\)</span>). To derive this we’ll make use of a simple argument (derived from branching processes). Our selected allele will be eventually lost from the population if every individual with the allele fails to leave descendants.</p>
<ol>
<li><p>In our first generation with probability <span class="math inline">\(P_0\)</span> our individual leaves no copies of itself to the next generation, in which case our allele is lost.</p></li>
<li><p>Alternatively it could leave one copy of itself to the next generation (with probability <span class="math inline">\(P_1\)</span>), in which case with probability <span class="math inline">\(p_L\)</span> this copy eventually goes extinct.</p></li>
<li><p>It could leave two copies of itself to the next generation (with probability <span class="math inline">\(P_2\)</span>), in which case with probability <span class="math inline">\(p_L^2\)</span> both of these copies eventually goes extinct.</p></li>
<li><p>More generally it could leave could leave <span class="math inline">\(k\)</span> copies (<span class="math inline">\(k&gt;0\)</span>) of itself to the next generation (with probability <span class="math inline">\(P_k\)</span>), in which case with probability <span class="math inline">\(p_L^k\)</span> all of these copies eventually go extinct.</p></li>
</ol>
<p>summing over this probabilities we see that <span class="math display">\[\begin{aligned}
p_L &amp;= \sum_{k=0}^{\infty} P_k p_L^{k}  \nonumber \\
&amp;=  \sum_{k=0}^{\infty} \frac{(1+s)^ke^{-(1+s)}}{k!} p_L^{k} \nonumber
\\
&amp;= e^{-(1+s)} \left( \sum_{k=0}^{\infty} \frac{\left(p_L(1+s) \right)^k}{k!}  \right)\end{aligned}\]</span> well the term in the brackets is itself an exponential expansion, so we can rewrite this as <span class="math display">\[p_L = e^{(1+s)(p_L-1)} \label{prob_loss}\]</span> solving this would give us our probability of loss for any selection coefficient. Lets rewrite this in terms of the the probability of escaping loss <span class="math inline">\(p_F = 1-p_L\)</span>. We can rewrite eqn as <span class="math display">\[1-p_F = e^{-p_F(1+s)}\]</span> to gain an approximation to this lets consider a small selection coefficient <span class="math inline">\(s \ll 1\)</span> such that <span class="math inline">\(p_F \ll 1\)</span> and then expanded out the exponential on the right hand side (ignoring terms of higher order than <span class="math inline">\(s^2\)</span> and <span class="math inline">\(p_F^2\)</span>) then <span class="math display">\[1-p_F \approx 1-p_F(1+s)+p_F^2(1+s)^2/2\]</span> solving this we find that <span class="math display">\[p_F = 2s.\]</span> Thus even an allele with a <span class="math inline">\(1\%\)</span> selection coefficient has a <span class="math inline">\(98\%\)</span> probability of being lost when it is first introduced into the population by mutation.<br />
We can also adapt this result to a diploid setting. Assuming that heterozygotes for the <span class="math inline">\(1\)</span> allele have <span class="math inline">\(1+(1-h)s\)</span> children, the probability of allele <span class="math inline">\(1\)</span> is not lost, starting from a single copy in the population, is <span class="math display">\[p_F = 2 (1-h)s \label{eqn:diploid_escape}\]</span> for <span class="math inline">\(h&gt;0\)</span>.<br />
</p>
<h2 id="the-interaction-between-genetic-drift-and-weak-selection.">The interaction between genetic drift and weak selection.</h2>
<p>For strongly selected alleles, once the allele has escaped initial loss at low frequencies, their path will be determined deterministically by their selection coefficients. However, if selection is weak the stochasticity of reproduction can play a role in the trajectory an allele takes even when it is common in the population.<br />
To see this lets think of our simple Wright-Fisher model (see R exercise). Each generation we allow a deterministic change in our allele frequency, and then binomially sample two alleles for each of our offspring to construct our next generation.<br />
So the expected change in our allele frequency within a generation is given just by our deterministic formula. To make things easy on our self lets assume an additive model, i.e. <span class="math inline">\(h=1/2\)</span>, and that <span class="math inline">\(s \ll 1\)</span> so that <span class="math inline">\({\overline{w}}\approx 1\)</span>. This gives us <span class="math display">\[{\mathbb{E}}(\Delta p ) = \frac{s}{2} p(1-p) \label{eqn:WF_mean}\]</span> our variance in our allele frequency change is given by <span class="math display">\[Var(p^{\prime} - p) = Var(p^{\prime}) = \frac{p^{\prime}(1-p^{\prime})}{2N}\]</span> this variance in our allele frequency follows from the fact that we are binomially sampling <span class="math inline">\(2N\)</span> new alleles in the next generation from a frequency <span class="math inline">\(p^{\prime}\)</span>. Denoting our count of allele <span class="math inline">\(1\)</span> by <span class="math inline">\(i\)</span> our <span class="math display">\[Var(p^{\prime} - p) = Var(\frac{i}{2N} - p) =  Var(\frac{i}{2N} ) =\frac{Var(i)}{(2N)^2}\]</span> and from binomial sampling <span class="math inline">\(Var(i) = 2N p^{\prime}(1-p^{\prime})\)</span> and so we arrive at our answer. Assuming that <span class="math inline">\(s \ll 1\)</span>, <span class="math inline">\(p^{\prime}
\approx p\)</span>, then in practice we can use <span class="math display">\[Var(\Delta p)  =Var(p^{\prime} - p) \approx \frac{p(1-p)}{2N}. \label{eqn:WF_var}\]</span> To get our first look at the relative effects of selection vs drift we can simply look at when our change in allele frequency caused selection within a generate is reasonably faithfully passed across the generations. In particular if our expected change in frequency is much great than the variance around this change, genetic drift will play little role in the fate of our selected allele (once the allele is not too rare within the population). When does selected dominant genetic drift? This will happen if <span class="math inline">\({\mathbb{E}}(\Delta p) \gg Var(\Delta p)\)</span> when <span class="math inline">\(Ns \gg 1\)</span>. Conversely any hope of our selected allele following its deterministic path will be quickly undone if our change in allele frequencies due to selection is much less than the variance induced by drift. So if <span class="math inline">\(Ns \ll 1\)</span> then drift will dominate the fate of our allele.<br />
To make further progress on understanding the fate of alleles with selection coefficients of the order <span class="math inline">\(1/N\)</span> requires more careful modeling. However, we can obtain the probability that under our diploid model, with an additive selection coefficient <span class="math inline">\(s\)</span>, the probability of allele <span class="math inline">\(1\)</span> fixing within the population starting from a frequency <span class="math inline">\(p\)</span> is given by <span class="math display">\[\pi(p) = \frac{1-e^{-2Ns p }}{1-e^{-2Ns}} \label{eqn:prob_fixed}\]</span> the proof of this is sketched out below (see Section [Section:fixation_weakly_sel]). A new allele will arrive in the population at frequency <span class="math inline">\(p=1/(2N)\)</span>, then its probability of reaching fixation is <span class="math display">\[\pi \left(\frac{1}{2N} \right) = \frac{1-e^{-s }}{1-e^{-2Ns}}\]</span> if <span class="math inline">\(s \ll1\)</span> but <span class="math inline">\(Ns \gg 1\)</span> then <span class="math inline">\(\pi(\frac{1}{2N}) \approx s\)</span>, which nicely gives us back our result that we obtained above (eqn. ).<br />
In the case where <span class="math inline">\(Ns\)</span> close to <span class="math inline">\(1\)</span> then <span class="math display">\[\pi(\frac{1}{2N}) \approx \frac{s}{1-e^{-2Ns}} \label{eqn:escape_from_intro}\]</span> this is greater than <span class="math inline">\(s\)</span>, increasingly so for smaller <span class="math inline">\(N\)</span>. Why is this? Well in small populations selected alleles spend a somewhat shorter time segregating (especially at low frequencies), and so are slightly less susceptible to genetic drift.<br />
</p>
<h3 id="the-fixation-of-slightly-deleterious-alleles.">The fixation of slightly deleterious alleles.</h3>
<p>We can also use eqn. to understand how likely it is that deleterious alleles accidently reach fixation by genetic drift, assuming a diploid model with additive selection (with a selection coefficient of <span class="math inline">\(-s\)</span> against our allele <span class="math inline">\(2\)</span>). If <span class="math inline">\(N s \gg 1\)</span> then our deleterious allele (allele <span class="math inline">\(2\)</span>) can not possibly reach fixation. However, if <span class="math inline">\(Ns\)</span> is not large then <span class="math display">\[\pi(\frac{1}{2N}) = \frac{s}{e^{2Ns}-1} \label{eqn:fix_deleterious}\]</span> for our deleterious allele. So deleterious alleles can fix within populations (albeit at a low rate) if <span class="math inline">\(Ns\)</span> is not too large.<br />
</p>
<h3 id="Section:fixation_weakly_sel">A Sketch Proof of the probability of fixation of weakly selected alleles</h3>
<p>We’ll let <span class="math inline">\(P(\Delta p)\)</span> be the probability that our allele frequency shifts by <span class="math inline">\(\Delta p\)</span> in the next generation. Using this we can write our probability <span class="math inline">\(\pi(p)\)</span> in terms of the probability of achieving fixation averaged over the frequency in the next generation <span class="math display">\[\pi(p)  = \int \pi(p+\Delta p) P(\Delta p) d(\Delta p) \label{eqn:prob_fix_diff_step1}\]</span> This is very similar to the technique that we used deriving our probability of escaping loss in a very large population above.<br />
So we need an expression for <span class="math inline">\(\pi(p+\Delta p)\)</span>. To obtain this we’ll do a Taylor series expansion of <span class="math inline">\(\pi(p)\)</span> assuming that <span class="math inline">\(\Delta p \)</span> is small <span class="math display">\[\pi(p+\Delta p) \approx \pi(p) + \Delta p \frac{d\pi(p)}{dp} + (\Delta p)^2
\frac{d^2\pi(p)}{dp^2} (p)\]</span> ignoring higher order terms.<br />
Taking the expectation over <span class="math inline">\(\Delta p \)</span> on both sides, as in eqn. [eqn:prob_fix_diff_step1], we obtain <span class="math display">\[\pi(p) = \pi(p) + {\mathbb{E}}(\Delta p) \frac{d\pi (p)}{dp} + {\mathbb{E}}((\Delta p)^2)
\frac{d^2\pi(p)}{dp^2}\]</span></p>
<p>Well <span class="math inline">\({\mathbb{E}}(\Delta p) = \frac{s}{2}p(1-p)\)</span> and <span class="math inline">\(Var(\Delta p)= {\mathbb{E}}((\Delta
p)^2)-{\mathbb{E}}^2(\Delta p)\)</span>, so if <span class="math inline">\(s \ll 1\)</span> then <span class="math inline">\({\mathbb{E}}^2(\Delta p) \approx
0\)</span>, and <span class="math inline">\({\mathbb{E}}(\Delta p)^2 = \frac{p(1-p)}{2N}\)</span>. This leaves us with <span class="math display">\[0= \frac{s}{2}p(1-p)\frac{d\pi (p) }{dp} + \frac{p(1-p)}{2N}
\frac{d^2\pi (p) }{dp^2}\]</span> and we can specify the boundary conditions to be <span class="math inline">\(\pi(1)=1\)</span> and <span class="math inline">\(\pi(0)=0\)</span>. Solving this differential equation is somewhat involved process but in doing so we find that <span class="math display">\[\pi(p) = \frac{1-e^{-2Ns p }}{1-e^{-2Ns}}\]</span></p>
</body>
</html>
